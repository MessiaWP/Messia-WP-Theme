1702936352
waR3U4bTeM%3Ae282c0853fe743643ee002d426f3f987-c5223e7cca302db1dbe3d26688b138e1
s:17744:"TzozMzoicGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxGaWxlIjoxNDp7czo0MzoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcRmlsZQBkb2NCbG9jayI7TjtzOjM5OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxGaWxlAGhhc2giO3M6MzI6ImM1MjIzZTdjY2EzMDJkYjFkYmUzZDI2Njg4YjEzOGUxIjtzOjM5OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxGaWxlAG5hbWUiO3M6MTc6Il9jb21tZW50LXJlcGx5LmpzIjtzOjM5OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxGaWxlAHBhdGgiO3M6MzY6InNyYy9qcy9fY29tcG9uZW50cy9fY29tbWVudC1yZXBseS5qcyI7czo0MToiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcRmlsZQBzb3VyY2UiO3M6MTIzODY6Ii8qKgogKiBUaGlzIGlzIGEgZnVsbCBjb3B5IG9mIG9yaWdpbmFsIGluY2x1ZGVzL2pzL2NvbW1lbnQtcmVwbHkuanMKICoKICogQHR5cGUge09iamVjdH0KICovCndpbmRvdy5hZGRDb21tZW50ID0gKCBmdW5jdGlvbiggd2luZG93ICkgewoJLy8gQXZvaWQgc2NvcGUgbG9va3VwcyBvbiBjb21tb25seSB1c2VkIHZhcmlhYmxlcy4KCXZhciBkb2N1bWVudCA9IHdpbmRvdy5kb2N1bWVudDsKCgkvLyBTZXR0aW5ncy4KCXZhciBjb25maWcgPSB7CgkJY29tbWVudFJlcGx5Q2xhc3MgICA6ICdjb21tZW50LXJlcGx5LWxpbmsnLAoJCWNvbW1lbnRSZXBseVRpdGxlSWQgOiAncmVwbHktdGl0bGUnLAoJCWNhbmNlbFJlcGx5SWQgICAgICAgOiAnY2FuY2VsLWNvbW1lbnQtcmVwbHktbGluaycsCgkJY29tbWVudEZvcm1JZCAgICAgICA6ICdjb21tZW50Zm9ybScsCgkJdGVtcG9yYXJ5Rm9ybUlkICAgICA6ICd3cC10ZW1wLWZvcm0tZGl2JywKCQlwYXJlbnRJZEZpZWxkSWQgICAgIDogJ2NvbW1lbnRfcGFyZW50JywKCQlwb3N0SWRGaWVsZElkICAgICAgIDogJ2NvbW1lbnRfcG9zdF9JRCcKCX07CgoJLy8gQ3Jvc3MgYnJvd3NlciBNdXRhdGlvbk9ic2VydmVyLgoJdmFyIE11dGF0aW9uT2JzZXJ2ZXIgPSB3aW5kb3cuTXV0YXRpb25PYnNlcnZlciB8fCB3aW5kb3cuV2ViS2l0TXV0YXRpb25PYnNlcnZlciB8fCB3aW5kb3cuTW96TXV0YXRpb25PYnNlcnZlcjsKCgkvLyBDaGVjayBicm93c2VyIGN1dHMgdGhlIG11c3RhcmQuCgl2YXIgY3V0c1RoZU11c3RhcmQgPSAncXVlcnlTZWxlY3RvcicgaW4gZG9jdW1lbnQgJiYgJ2FkZEV2ZW50TGlzdGVuZXInIGluIHdpbmRvdzsKCgkvKgoJICogQ2hlY2sgYnJvd3NlciBzdXBwb3J0cyBkYXRhc2V0LgoJICogISEgc2V0cyB0aGUgdmFyaWFibGUgdG8gdHJ1ZSBpZiB0aGUgcHJvcGVydHkgZXhpc3RzLgoJICovCgl2YXIgc3VwcG9ydHNEYXRhc2V0ID0gISEgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmRhdGFzZXQ7CgoJLy8gRm9yIGhvbGRpbmcgdGhlIGNhbmNlbCBlbGVtZW50LgoJdmFyIGNhbmNlbEVsZW1lbnQ7CgoJLy8gRm9yIGhvbGRpbmcgdGhlIGNvbW1lbnQgZm9ybSBlbGVtZW50LgoJdmFyIGNvbW1lbnRGb3JtRWxlbWVudDsKCgkvLyBUaGUgcmVzcG9uZCBlbGVtZW50LgoJdmFyIHJlc3BvbmRFbGVtZW50OwoKCS8vIFRoZSBtdXRhdGlvbiBvYnNlcnZlci4KCXZhciBvYnNlcnZlcjsKCglpZiAoIGN1dHNUaGVNdXN0YXJkICYmIGRvY3VtZW50LnJlYWR5U3RhdGUgIT09ICdsb2FkaW5nJyApIHsKCQlyZWFkeSgpOwoJfSBlbHNlIGlmICggY3V0c1RoZU11c3RhcmQgKSB7CgkJd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoICdET01Db250ZW50TG9hZGVkJywgcmVhZHksIGZhbHNlICk7Cgl9CgoJLyoqCgkgKiBTZXRzIHVwIG9iamVjdCB2YXJpYWJsZXMgYWZ0ZXIgdGhlIERPTSBpcyByZWFkeS4KCSAqCgkgKiBAc2luY2UgNS4xLjEKCSAqLwoJZnVuY3Rpb24gcmVhZHkoKSB7CgkJLy8gSW5pdGlhbGlzZSB0aGUgZXZlbnRzLgoJCWluaXQoKTsKCgkJLy8gU2V0IHVwIGEgTXV0YXRpb25PYnNlcnZlciB0byBjaGVjayBmb3IgY29tbWVudHMgbG9hZGVkIGxhdGUuCgkJb2JzZXJ2ZUNoYW5nZXMoKTsKCX0KCgkvKioKCSAqIEFkZCBldmVudHMgdG8gbGlua3MgY2xhc3NlZCAuY29tbWVudC1yZXBseS1saW5rLgoJICoKCSAqIFNlYXJjaGVzIHRoZSBjb250ZXh0IGZvciByZXBseSBsaW5rcyBhbmQgYWRkcyB0aGUgSmF2YVNjcmlwdCBldmVudHMKCSAqIHJlcXVpcmVkIHRvIG1vdmUgdGhlIGNvbW1lbnQgZm9ybS4gVG8gYWxsb3cgZm9yIGxhenkgbG9hZGluZyBvZgoJICogY29tbWVudHMgdGhpcyBtZXRob2QgaXMgZXhwb3NlZCBhcyB3aW5kb3cuY29tbWVudFJlcGx5LmluaXQoKS4KCSAqCgkgKiBAc2luY2UgNS4xLjAKCSAqCgkgKiBAbWVtYmVyT2YgYWRkQ29tbWVudAoJICoKCSAqIEBwYXJhbSB7SFRNTEVsZW1lbnR9IGNvbnRleHQgVGhlIHBhcmVudCBET00gZWxlbWVudCB0byBzZWFyY2ggZm9yIGxpbmtzLgoJICovCglmdW5jdGlvbiBpbml0KCBjb250ZXh0ICkgewoJCWlmICggISBjdXRzVGhlTXVzdGFyZCApIHsKCQkJcmV0dXJuOwoJCX0KCgkJLy8gR2V0IHJlcXVpcmVkIGVsZW1lbnRzLgoJCWNhbmNlbEVsZW1lbnQgPSBnZXRFbGVtZW50QnlJZCggY29uZmlnLmNhbmNlbFJlcGx5SWQgKTsKCQljb21tZW50Rm9ybUVsZW1lbnQgPSBnZXRFbGVtZW50QnlJZCggY29uZmlnLmNvbW1lbnRGb3JtSWQgKTsKCgkJLy8gTm8gY2FuY2VsIGVsZW1lbnQsIG5vIHJlcGxpZXMuCgkJaWYgKCAhIGNhbmNlbEVsZW1lbnQgKSB7CgkJCXJldHVybjsKCQl9CgoJCWNhbmNlbEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lciggJ3RvdWNoc3RhcnQnLCBjYW5jZWxFdmVudCApOwoJCWNhbmNlbEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lciggJ2NsaWNrJywgICAgICBjYW5jZWxFdmVudCApOwoKCQkvLyBTdWJtaXQgdGhlIGNvbW1lbnQgZm9ybSB3aGVuIHRoZSB1c2VyIHR5cGVzIFtDdHJsXSBvciBbQ21kXSArIFtFbnRlcl0uCgkJdmFyIHN1Ym1pdEZvcm1IYW5kbGVyID0gZnVuY3Rpb24oIGUgKSB7CgkJCWlmICggKCBlLm1ldGFLZXkgfHwgZS5jdHJsS2V5ICkgJiYgZS5rZXlDb2RlID09PSAxMyApIHsKCQkJCWNvbW1lbnRGb3JtRWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCAna2V5ZG93bicsIHN1Ym1pdEZvcm1IYW5kbGVyICk7CgkJCQllLnByZXZlbnREZWZhdWx0KCk7CgkJCQkvLyBUaGUgc3VibWl0IGJ1dHRvbiBJRCBpcyAnc3VibWl0JyBzbyB3ZSBjYW4ndCBjYWxsIGNvbW1lbnRGb3JtRWxlbWVudC5zdWJtaXQoKS4gQ2xpY2sgaXQgaW5zdGVhZC4KCQkJCWNvbW1lbnRGb3JtRWxlbWVudC5zdWJtaXQuY2xpY2soKTsKCQkJCXJldHVybiBmYWxzZTsKCQkJfQoJCX07CgoJCWlmICggY29tbWVudEZvcm1FbGVtZW50ICkgewoJCQljb21tZW50Rm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lciggJ2tleWRvd24nLCBzdWJtaXRGb3JtSGFuZGxlciApOwoJCX0KCgkJdmFyIGxpbmtzID0gcmVwbHlMaW5rcyggY29udGV4dCApOwoJCXZhciBlbGVtZW50OwoKCQlmb3IgKCB2YXIgaSA9IDAsIGwgPSBsaW5rcy5sZW5ndGg7IGkgPCBsOyBpKysgKSB7CgkJCWVsZW1lbnQgPSBsaW5rc1tpXTsKCgkJCWVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lciggJ3RvdWNoc3RhcnQnLCBjbGlja0V2ZW50ICk7CgkJCWVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lciggJ2NsaWNrJywgICAgICBjbGlja0V2ZW50ICk7CgkJfQoJfQoKCS8qKgoJICogUmV0dXJuIGFsbCBsaW5rcyBjbGFzc2VkIC5jb21tZW50LXJlcGx5LWxpbmsuCgkgKgoJICogQHNpbmNlIDUuMS4wCgkgKgoJICogQHBhcmFtIHtIVE1MRWxlbWVudH0gY29udGV4dCBUaGUgcGFyZW50IERPTSBlbGVtZW50IHRvIHNlYXJjaCBmb3IgbGlua3MuCgkgKgoJICogQHJldHVybiB7SFRNTENvbGxlY3Rpb258Tm9kZUxpc3R8QXJyYXl9CgkgKi8KCWZ1bmN0aW9uIHJlcGx5TGlua3MoIGNvbnRleHQgKSB7CgkJdmFyIHNlbGVjdG9yQ2xhc3MgPSBjb25maWcuY29tbWVudFJlcGx5Q2xhc3M7CgkJdmFyIGFsbFJlcGx5TGlua3M7CgoJCS8vIGNoaWxkTm9kZXMgaXMgYSBoYW5keSBjaGVjayB0byBlbnN1cmUgdGhlIGNvbnRleHQgaXMgYSBIVE1MRWxlbWVudC4KCQlpZiAoICEgY29udGV4dCB8fCAhIGNvbnRleHQuY2hpbGROb2RlcyApIHsKCQkJY29udGV4dCA9IGRvY3VtZW50OwoJCX0KCgkJaWYgKCBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lICkgewoJCQkvLyBGYXN0ZXN0LgoJCQlhbGxSZXBseUxpbmtzID0gY29udGV4dC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCBzZWxlY3RvckNsYXNzICk7CgkJfQoJCWVsc2UgewoJCQkvLyBGYXN0LgoJCQlhbGxSZXBseUxpbmtzID0gY29udGV4dC5xdWVyeVNlbGVjdG9yQWxsKCAnLicgKyBzZWxlY3RvckNsYXNzICk7CgkJfQoKCQlyZXR1cm4gYWxsUmVwbHlMaW5rczsKCX0KCgkvKioKCSAqIENhbmNlbCBldmVudCBoYW5kbGVyLgoJICoKCSAqIEBzaW5jZSA1LjEuMAoJICoKCSAqIEBwYXJhbSB7RXZlbnR9IGV2ZW50IFRoZSBjYWxsaW5nIGV2ZW50LgoJICovCglmdW5jdGlvbiBjYW5jZWxFdmVudCggZXZlbnQgKSB7CgkJdmFyIGNhbmNlbExpbmsgPSB0aGlzOwoJCXZhciB0ZW1wb3JhcnlGb3JtSWQgID0gY29uZmlnLnRlbXBvcmFyeUZvcm1JZDsKCQl2YXIgdGVtcG9yYXJ5RWxlbWVudCA9IGdldEVsZW1lbnRCeUlkKCB0ZW1wb3JhcnlGb3JtSWQgKTsKCgkJaWYgKCAhIHRlbXBvcmFyeUVsZW1lbnQgfHwgISByZXNwb25kRWxlbWVudCApIHsKCQkJLy8gQ29uZGl0aW9ucyBmb3IgY2FuY2VsIGxpbmsgZmFpbC4KCQkJcmV0dXJuOwoJCX0KCgkJZ2V0RWxlbWVudEJ5SWQoIGNvbmZpZy5wYXJlbnRJZEZpZWxkSWQgKS52YWx1ZSA9ICcwJzsKCgkJLy8gTW92ZSB0aGUgcmVzcG9uZCBmb3JtIGJhY2sgaW4gcGxhY2Ugb2YgdGhlIHRlbXBvcmFyeSBlbGVtZW50LgoJCXZhciBoZWFkaW5nVGV4dCA9IHRlbXBvcmFyeUVsZW1lbnQudGV4dENvbnRlbnQ7CgkJdGVtcG9yYXJ5RWxlbWVudC5wYXJlbnROb2RlLnJlcGxhY2VDaGlsZCggcmVzcG9uZEVsZW1lbnQsIHRlbXBvcmFyeUVsZW1lbnQgKTsKCQljYW5jZWxMaW5rLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CgoJCXZhciByZXBseUhlYWRpbmdFbGVtZW50ICA9IGdldEVsZW1lbnRCeUlkKCBjb25maWcuY29tbWVudFJlcGx5VGl0bGVJZCApOwoJCXZhciByZXBseUhlYWRpbmdUZXh0Tm9kZSA9IHJlcGx5SGVhZGluZ0VsZW1lbnQgJiYgcmVwbHlIZWFkaW5nRWxlbWVudC5maXJzdENoaWxkOwoJCXZhciByZXBseUxpbmtUb1BhcmVudCAgICA9IHJlcGx5SGVhZGluZ1RleHROb2RlICYmIHJlcGx5SGVhZGluZ1RleHROb2RlLm5leHRTaWJsaW5nOwoKCQlpZiAoIHJlcGx5SGVhZGluZ1RleHROb2RlICYmIHJlcGx5SGVhZGluZ1RleHROb2RlLm5vZGVUeXBlID09PSBOb2RlLlRFWFRfTk9ERSAmJiBoZWFkaW5nVGV4dCApIHsKCQkJaWYgKCByZXBseUxpbmtUb1BhcmVudCAmJiAnQScgPT09IHJlcGx5TGlua1RvUGFyZW50Lm5vZGVOYW1lICYmIHJlcGx5TGlua1RvUGFyZW50LmlkICE9PSBjb25maWcuY2FuY2VsUmVwbHlJZCApIHsKCQkJCXJlcGx5TGlua1RvUGFyZW50LnN0eWxlLmRpc3BsYXkgPSAnJzsKCQkJfQoKCQkJcmVwbHlIZWFkaW5nVGV4dE5vZGUudGV4dENvbnRlbnQgPSBoZWFkaW5nVGV4dDsKCQl9CgoJCWV2ZW50LnByZXZlbnREZWZhdWx0KCk7Cgl9CgoJLyoqCgkgKiBDbGljayBldmVudCBoYW5kbGVyLgoJICoKCSAqIEBzaW5jZSA1LjEuMAoJICoKCSAqIEBwYXJhbSB7RXZlbnR9IGV2ZW50IFRoZSBjYWxsaW5nIGV2ZW50LgoJICovCglmdW5jdGlvbiBjbGlja0V2ZW50KCBldmVudCApIHsKCQl2YXIgcmVwbHlOb2RlID0gZ2V0RWxlbWVudEJ5SWQoIGNvbmZpZy5jb21tZW50UmVwbHlUaXRsZUlkICk7CgkJdmFyIGRlZmF1bHRSZXBseUhlYWRpbmcgPSByZXBseU5vZGUgJiYgcmVwbHlOb2RlLmZpcnN0Q2hpbGQudGV4dENvbnRlbnQ7CgkJdmFyIHJlcGx5TGluayA9IHRoaXMsCgkJCWNvbW1JZCAgICA9IGdldERhdGFBdHRyaWJ1dGUoIHJlcGx5TGluaywgJ2JlbG93ZWxlbWVudCcgKSwKCQkJcGFyZW50SWQgID0gZ2V0RGF0YUF0dHJpYnV0ZSggcmVwbHlMaW5rLCAnY29tbWVudGlkJyApLAoJCQlyZXNwb25kSWQgPSBnZXREYXRhQXR0cmlidXRlKCByZXBseUxpbmssICdyZXNwb25kZWxlbWVudCcgKSwKCQkJcG9zdElkICAgID0gZ2V0RGF0YUF0dHJpYnV0ZSggcmVwbHlMaW5rLCAncG9zdGlkJyApLAoJCQlyZXBseVRvICAgPSBnZXREYXRhQXR0cmlidXRlKCByZXBseUxpbmssICdyZXBseXRvJyApIHx8IGRlZmF1bHRSZXBseUhlYWRpbmcsCgkJCWZvbGxvdzsKCgkJaWYgKCAhIGNvbW1JZCB8fCAhIHBhcmVudElkIHx8ICEgcmVzcG9uZElkIHx8ICEgcG9zdElkICkgewoJCQkvKgoJCQkgKiBUaGVtZSBvciBwbHVnaW4gZGVmaW5lcyBvd24gbGluayB2aWEgY3VzdG9tIGB3cF9saXN0X2NvbW1lbnRzKClgIGNhbGxiYWNrCgkJCSAqIGFuZCBjYWxscyBgbW92ZUZvcm0oKWAgZWl0aGVyIGRpcmVjdGx5IG9yIHZpYSBhIGN1c3RvbSBldmVudCBob29rLgoJCQkgKi8KCQkJcmV0dXJuOwoJCX0KCgkJLyoKCQkgKiBUaGlyZCBwYXJ0eSBjb21tZW50cyBzeXN0ZW1zIGNhbiBob29rIGludG8gdGhpcyBmdW5jdGlvbiB2aWEgdGhlIGdsb2JhbCBzY29wZSwKCQkgKiB0aGVyZWZvcmUgdGhlIGNsaWNrIGV2ZW50IG5lZWRzIHRvIHJlZmVyZW5jZSB0aGUgZ2xvYmFsIHNjb3BlLgoJCSAqLwoJCWZvbGxvdyA9IHdpbmRvdy5hZGRDb21tZW50Lm1vdmVGb3JtKCBjb21tSWQsIHBhcmVudElkLCByZXNwb25kSWQsIHBvc3RJZCwgcmVwbHlUbyApOwoJCWlmICggZmFsc2UgPT09IGZvbGxvdyApIHsKCQkJZXZlbnQucHJldmVudERlZmF1bHQoKTsKCQl9Cgl9CgoJLyoqCgkgKiBDcmVhdGVzIGEgbXV0YXRpb24gb2JzZXJ2ZXIgdG8gY2hlY2sgZm9yIG5ld2x5IGluc2VydGVkIGNvbW1lbnRzLgoJICoKCSAqIEBzaW5jZSA1LjEuMAoJICovCglmdW5jdGlvbiBvYnNlcnZlQ2hhbmdlcygpIHsKCQlpZiAoICEgTXV0YXRpb25PYnNlcnZlciApIHsKCQkJcmV0dXJuOwoJCX0KCgkJdmFyIG9ic2VydmVyT3B0aW9ucyA9IHsKCQkJY2hpbGRMaXN0OiB0cnVlLAoJCQlzdWJ0cmVlOiB0cnVlCgkJfTsKCgkJb2JzZXJ2ZXIgPSBuZXcgTXV0YXRpb25PYnNlcnZlciggaGFuZGxlQ2hhbmdlcyApOwoJCW9ic2VydmVyLm9ic2VydmUoIGRvY3VtZW50LmJvZHksIG9ic2VydmVyT3B0aW9ucyApOwoJfQoKCS8qKgoJICogSGFuZGxlcyBET00gY2hhbmdlcywgY2FsbGluZyBpbml0KCkgaWYgYW55IG5ldyBub2RlcyBhcmUgYWRkZWQuCgkgKgoJICogQHNpbmNlIDUuMS4wCgkgKgoJICogQHBhcmFtIHtBcnJheX0gbXV0YXRpb25SZWNvcmRzIEFycmF5IG9mIE11dGF0aW9uUmVjb3JkIG9iamVjdHMuCgkgKi8KCWZ1bmN0aW9uIGhhbmRsZUNoYW5nZXMoIG11dGF0aW9uUmVjb3JkcyApIHsKCQl2YXIgaSA9IG11dGF0aW9uUmVjb3Jkcy5sZW5ndGg7CgoJCXdoaWxlICggaS0tICkgewoJCQkvLyBDYWxsIGluaXQoKSBvbmNlIGlmIGFueSByZWNvcmQgaW4gdGhpcyBzZXQgYWRkcyBub2Rlcy4KCQkJaWYgKCBtdXRhdGlvblJlY29yZHNbIGkgXS5hZGRlZE5vZGVzLmxlbmd0aCApIHsKCQkJCWluaXQoKTsKCQkJCXJldHVybjsKCQkJfQoJCX0KCX0KCgkvKioKCSAqIEJhY2t3YXJkIGNvbXBhdGlibGUgZ2V0dGVyIG9mIGRhdGEtKiBhdHRyaWJ1dGUuCgkgKgoJICogVXNlcyBlbGVtZW50LmRhdGFzZXQgaWYgaXQgZXhpc3RzLCBvdGhlcndpc2UgdXNlcyBnZXRBdHRyaWJ1dGUuCgkgKgoJICogQHNpbmNlIDUuMS4wCgkgKgoJICogQHBhcmFtIHtIVE1MRWxlbWVudH0gRWxlbWVudCBET00gZWxlbWVudCB3aXRoIHRoZSBhdHRyaWJ1dGUuCgkgKiBAcGFyYW0ge3N0cmluZ30gICAgICBBdHRyaWJ1dGUgdGhlIGF0dHJpYnV0ZSB0byBnZXQuCgkgKgoJICogQHJldHVybiB7c3RyaW5nfQoJICovCglmdW5jdGlvbiBnZXREYXRhQXR0cmlidXRlKCBlbGVtZW50LCBhdHRyaWJ1dGUgKSB7CgkJaWYgKCBzdXBwb3J0c0RhdGFzZXQgKSB7CgkJCXJldHVybiBlbGVtZW50LmRhdGFzZXRbYXR0cmlidXRlXTsKCQl9CgkJZWxzZSB7CgkJCXJldHVybiBlbGVtZW50LmdldEF0dHJpYnV0ZSggJ2RhdGEtJyArIGF0dHJpYnV0ZSApOwoJCX0KCX0KCgkvKioKCSAqIEdldCBlbGVtZW50IGJ5IElELgoJICoKCSAqIExvY2FsIGFsaWFzIGZvciBkb2N1bWVudC5nZXRFbGVtZW50QnlJZC4KCSAqCgkgKiBAc2luY2UgNS4xLjAKCSAqCgkgKiBAcGFyYW0ge0hUTUxFbGVtZW50fSBUaGUgcmVxdWVzdGVkIGVsZW1lbnQuCgkgKi8KCWZ1bmN0aW9uIGdldEVsZW1lbnRCeUlkKCBlbGVtZW50SWQgKSB7CgkJcmV0dXJuIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCBlbGVtZW50SWQgKTsKCX0KCgkvKioKCSAqIE1vdmVzIHRoZSByZXBseSBmb3JtIGZyb20gaXRzIGN1cnJlbnQgcG9zaXRpb24gdG8gdGhlIHJlcGx5IGxvY2F0aW9uLgoJICoKCSAqIEBzaW5jZSAyLjcuMAoJICoKCSAqIEBtZW1iZXJPZiBhZGRDb21tZW50CgkgKgoJICogQHBhcmFtIHtzdHJpbmd9IGFkZEJlbG93SWQgSFRNTCBJRCBvZiBlbGVtZW50IHRoZSBmb3JtIGZvbGxvd3MuCgkgKiBAcGFyYW0ge3N0cmluZ30gY29tbWVudElkICBEYXRhYmFzZSBJRCBvZiBjb21tZW50IGJlaW5nIHJlcGxpZWQgdG8uCgkgKiBAcGFyYW0ge3N0cmluZ30gcmVzcG9uZElkICBIVE1MIElEIG9mICdyZXNwb25kJyBlbGVtZW50LgoJICogQHBhcmFtIHtzdHJpbmd9IHBvc3RJZCAgICAgRGF0YWJhc2UgSUQgb2YgdGhlIHBvc3QuCgkgKiBAcGFyYW0ge3N0cmluZ30gcmVwbHlUbyAgICBGb3JtIGhlYWRpbmcgY29udGVudC4KCSAqLwoJZnVuY3Rpb24gbW92ZUZvcm0oIGFkZEJlbG93SWQsIGNvbW1lbnRJZCwgcmVzcG9uZElkLCBwb3N0SWQsIHJlcGx5VG8gKSB7CgkJLy8gR2V0IGVsZW1lbnRzIGJhc2VkIG9uIHRoZWlyIElEcy4KCQl2YXIgYWRkQmVsb3dFbGVtZW50ID0gZ2V0RWxlbWVudEJ5SWQoIGFkZEJlbG93SWQgKTsKCQlyZXNwb25kRWxlbWVudCAgPSBnZXRFbGVtZW50QnlJZCggcmVzcG9uZElkICk7CgoJCS8vIEdldCB0aGUgaGlkZGVuIGZpZWxkcy4KCQl2YXIgcGFyZW50SWRGaWVsZCAgID0gZ2V0RWxlbWVudEJ5SWQoIGNvbmZpZy5wYXJlbnRJZEZpZWxkSWQgKTsKCQl2YXIgcG9zdElkRmllbGQgICAgID0gZ2V0RWxlbWVudEJ5SWQoIGNvbmZpZy5wb3N0SWRGaWVsZElkICk7CgkJdmFyIGVsZW1lbnQsIGNzc0hpZGRlbiwgc3R5bGU7CgoJCXZhciByZXBseUhlYWRpbmcgICAgICAgICA9IGdldEVsZW1lbnRCeUlkKCBjb25maWcuY29tbWVudFJlcGx5VGl0bGVJZCApOwoJCXZhciByZXBseUhlYWRpbmdUZXh0Tm9kZSA9IHJlcGx5SGVhZGluZyAmJiByZXBseUhlYWRpbmcuZmlyc3RDaGlsZDsKCQl2YXIgcmVwbHlMaW5rVG9QYXJlbnQgICAgPSByZXBseUhlYWRpbmdUZXh0Tm9kZSAmJiByZXBseUhlYWRpbmdUZXh0Tm9kZS5uZXh0U2libGluZzsKCgkJaWYgKCAhIGFkZEJlbG93RWxlbWVudCB8fCAhIHJlc3BvbmRFbGVtZW50IHx8ICEgcGFyZW50SWRGaWVsZCApIHsKCQkJLy8gTWlzc2luZyBrZXkgZWxlbWVudHMsIGZhaWwuCgkJCXJldHVybjsKCQl9CgoJCWlmICggJ3VuZGVmaW5lZCcgPT09IHR5cGVvZiByZXBseVRvICkgewoJCQlyZXBseVRvID0gcmVwbHlIZWFkaW5nVGV4dE5vZGUgJiYgcmVwbHlIZWFkaW5nVGV4dE5vZGUudGV4dENvbnRlbnQ7CgkJfQoKCQlhZGRQbGFjZUhvbGRlciggcmVzcG9uZEVsZW1lbnQgKTsKCgkJLy8gU2V0IHRoZSB2YWx1ZSBvZiB0aGUgcG9zdC4KCQlpZiAoIHBvc3RJZCAmJiBwb3N0SWRGaWVsZCApIHsKCQkJcG9zdElkRmllbGQudmFsdWUgPSBwb3N0SWQ7CgkJfQoKCQlwYXJlbnRJZEZpZWxkLnZhbHVlID0gY29tbWVudElkOwoKCQljYW5jZWxFbGVtZW50LnN0eWxlLmRpc3BsYXkgPSAnJzsKCQlhZGRCZWxvd0VsZW1lbnQucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoIHJlc3BvbmRFbGVtZW50LCBhZGRCZWxvd0VsZW1lbnQubmV4dFNpYmxpbmcgKTsKCgkJaWYgKCByZXBseUhlYWRpbmdUZXh0Tm9kZSAmJiByZXBseUhlYWRpbmdUZXh0Tm9kZS5ub2RlVHlwZSA9PT0gTm9kZS5URVhUX05PREUgKSB7CgkJCWlmICggcmVwbHlMaW5rVG9QYXJlbnQgJiYgJ0EnID09PSByZXBseUxpbmtUb1BhcmVudC5ub2RlTmFtZSAmJiByZXBseUxpbmtUb1BhcmVudC5pZCAhPT0gY29uZmlnLmNhbmNlbFJlcGx5SWQgKSB7CgkJCQlyZXBseUxpbmtUb1BhcmVudC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwoJCQl9CgoJCQlyZXBseUhlYWRpbmdUZXh0Tm9kZS50ZXh0Q29udGVudCA9IHJlcGx5VG87CgkJfQoKCQkvKgoJCSAqIFRoaXMgaXMgZm9yIGJhY2t3YXJkIGNvbXBhdGliaWxpdHkgd2l0aCB0aGlyZCBwYXJ0eSBjb21tZW50aW5nIHN5c3RlbXMKCQkgKiBob29raW5nIGludG8gdGhlIGV2ZW50IHVzaW5nIG9sZGVyIHRlY2huaXF1ZXMuCgkJICovCgkJY2FuY2VsRWxlbWVudC5vbmNsaWNrID0gZnVuY3Rpb24oKSB7CgkJCXJldHVybiBmYWxzZTsKCQl9OwoKCQkvLyBGb2N1cyBvbiB0aGUgZmlyc3QgZmllbGQgaW4gdGhlIGNvbW1lbnQgZm9ybS4KCQl0cnkgewoJCQlmb3IgKCB2YXIgaSA9IDA7IGkgPCBjb21tZW50Rm9ybUVsZW1lbnQuZWxlbWVudHMubGVuZ3RoOyBpKysgKSB7CgkJCQllbGVtZW50ID0gY29tbWVudEZvcm1FbGVtZW50LmVsZW1lbnRzW2ldOwoJCQkJY3NzSGlkZGVuID0gZmFsc2U7CgoJCQkJLy8gR2V0IGVsZW1lbnRzIGNvbXB1dGVkIHN0eWxlLgoJCQkJaWYgKCAnZ2V0Q29tcHV0ZWRTdHlsZScgaW4gd2luZG93ICkgewoJCQkJCS8vIE1vZGVybiBicm93c2Vycy4KCQkJCQlzdHlsZSA9IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKCBlbGVtZW50ICk7CgkJCQl9IGVsc2UgaWYgKCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY3VycmVudFN0eWxlICkgewoJCQkJCS8vIElFIDguCgkJCQkJc3R5bGUgPSBlbGVtZW50LmN1cnJlbnRTdHlsZTsKCQkJCX0KCgkJCQkvKgoJCQkJICogRm9yIGRpc3BsYXkgbm9uZSwgZG8gdGhlIHNhbWUgdGhpbmcgalF1ZXJ5IGRvZXMuIEZvciB2aXNpYmlsaXR5LAoJCQkJICogY2hlY2sgdGhlIGVsZW1lbnQgY29tcHV0ZWQgc3R5bGUgc2luY2UgYnJvd3NlcnMgYXJlIGFscmVhZHkgZG9pbmcKCQkJCSAqIHRoZSBqb2IgZm9yIHVzLiBJbiBmYWN0LCB0aGUgdmlzaWJpbGl0eSBjb21wdXRlZCBzdHlsZSBpcyB0aGUgYWN0dWFsCgkJCQkgKiBjb21wdXRlZCB2YWx1ZSBhbmQgYWxyZWFkeSB0YWtlcyBpbnRvIGFjY291bnQgdGhlIGVsZW1lbnQgYW5jZXN0b3JzLgoJCQkJICovCgkJCQlpZiAoICggZWxlbWVudC5vZmZzZXRXaWR0aCA8PSAwICYmIGVsZW1lbnQub2Zmc2V0SGVpZ2h0IDw9IDAgKSB8fCBzdHlsZS52aXNpYmlsaXR5ID09PSAnaGlkZGVuJyApIHsKCQkJCQljc3NIaWRkZW4gPSB0cnVlOwoJCQkJfQoKCQkJCS8vIFNraXAgZm9ybSBlbGVtZW50cyB0aGF0IGFyZSBoaWRkZW4gb3IgZGlzYWJsZWQuCgkJCQlpZiAoICdoaWRkZW4nID09PSBlbGVtZW50LnR5cGUgfHwgZWxlbWVudC5kaXNhYmxlZCB8fCBjc3NIaWRkZW4gKSB7CgkJCQkJY29udGludWU7CgkJCQl9CgoJCQkJZWxlbWVudC5mb2N1cygpOwoJCQkJLy8gU3RvcCBhZnRlciB0aGUgZmlyc3QgZm9jdXNhYmxlIGVsZW1lbnQuCgkJCQlicmVhazsKCQkJfQoJCX0KCQljYXRjaChlKSB7CgoJCX0KCgkJLyoKCQkgKiBmYWxzZSBpcyByZXR1cm5lZCBmb3IgYmFja3dhcmQgY29tcGF0aWJpbGl0eSB3aXRoIHRoaXJkIHBhcnR5IGNvbW1lbnRpbmcgc3lzdGVtcwoJCSAqIGhvb2tpbmcgaW50byB0aGlzIGZ1bmN0aW9uLgoJCSAqLwoJCXJldHVybiBmYWxzZTsKCX0KCgkvKioKCSAqIEFkZCBwbGFjZWhvbGRlciBlbGVtZW50LgoJICoKCSAqIFBsYWNlcyBhIHBsYWNlIGhvbGRlciBlbGVtZW50IGFib3ZlIHRoZSAjcmVzcG9uZCBlbGVtZW50IGZvcgoJICogdGhlIGZvcm0gdG8gYmUgcmV0dXJuZWQgdG8gaWYgbmVlZHMgYmUuCgkgKgoJICogQHNpbmNlIDIuNy4wCgkgKgoJICogQHBhcmFtIHtIVE1MZWxlbWVudH0gcmVzcG9uZEVsZW1lbnQgdGhlICNyZXNwb25kIGVsZW1lbnQgaG9sZGluZyBjb21tZW50IGZvcm0uCgkgKi8KCWZ1bmN0aW9uIGFkZFBsYWNlSG9sZGVyKCByZXNwb25kRWxlbWVudCApIHsKCQl2YXIgdGVtcG9yYXJ5Rm9ybUlkICA9IGNvbmZpZy50ZW1wb3JhcnlGb3JtSWQ7CgkJdmFyIHRlbXBvcmFyeUVsZW1lbnQgPSBnZXRFbGVtZW50QnlJZCggdGVtcG9yYXJ5Rm9ybUlkICk7CgkJdmFyIHJlcGx5RWxlbWVudCA9IGdldEVsZW1lbnRCeUlkKCBjb25maWcuY29tbWVudFJlcGx5VGl0bGVJZCApOwoJCXZhciBpbml0aWFsSGVhZGluZ1RleHQgPSByZXBseUVsZW1lbnQgPyByZXBseUVsZW1lbnQuZmlyc3RDaGlsZC50ZXh0Q29udGVudCA6ICcnOwoKCQlpZiAoIHRlbXBvcmFyeUVsZW1lbnQgKSB7CgkJCS8vIFRoZSBlbGVtZW50IGFscmVhZHkgZXhpc3RzLCBubyBuZWVkIHRvIHJlY3JlYXRlLgoJCQlyZXR1cm47CgkJfQoKCQl0ZW1wb3JhcnlFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggJ2RpdicgKTsKCQl0ZW1wb3JhcnlFbGVtZW50LmlkID0gdGVtcG9yYXJ5Rm9ybUlkOwoJCXRlbXBvcmFyeUVsZW1lbnQuc3R5bGUuZGlzcGxheSA9ICdub25lJzsKCQl0ZW1wb3JhcnlFbGVtZW50LnRleHRDb250ZW50ID0gaW5pdGlhbEhlYWRpbmdUZXh0OwoJCXJlc3BvbmRFbGVtZW50LnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKCB0ZW1wb3JhcnlFbGVtZW50LCByZXNwb25kRWxlbWVudCApOwoJfQoKCXJldHVybiB7CgkJaW5pdDogaW5pdCwKCQltb3ZlRm9ybTogbW92ZUZvcm0KCX07Cn0pKCB3aW5kb3cgKTsKIjtzOjQ1OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxGaWxlAG5hbWVzcGFjZXMiO2E6MDp7fXM6NDM6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXEZpbGUAaW5jbHVkZXMiO2E6MDp7fXM6NDQ6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXEZpbGUAZnVuY3Rpb25zIjthOjA6e31zOjQ0OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxGaWxlAGNvbnN0YW50cyI7YTowOnt9czo0MjoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcRmlsZQBjbGFzc2VzIjthOjA6e31zOjQ1OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxGaWxlAGludGVyZmFjZXMiO2E6MDp7fXM6NDE6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXEZpbGUAdHJhaXRzIjthOjA6e31zOjQwOiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxGaWxlAGVudW1zIjthOjA6e31zOjQzOiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxGaWxlAG1ldGFkYXRhIjthOjA6e319";