!function(){var e={247:function(e,t,s){s.g.MessiaExt=s.g.MessiaExt||{},s.g.MessiaExt={...s.g.MessiaExt,loader:(e,t)=>{const s=jQuery;return"show"===e?new Promise((e=>{s(`${t} > .messia-spinner`).length>0&&e("done"),s(t).append('<div class="messia-spinner"><div class="loading"><i></i><i></i><i></i><i></i></div></div>'),s(".overlay").addClass("overlay-show"),e("done")})):"hide"===e?new Promise((e=>{s(t).find(".messia-spinner").animate({opacity:0},100,"swing",(function(){s(this).remove(),s(".overlay").removeClass("overlay-show"),e("done")}))})):void 0}}},2591:function(e,t,s){const i=(()=>{const e={debug:"#7f8c8d",log:"#2ecc71",warn:"#f39c12",error:"#c0392b",table:"#c0392b"},t=function(t,s){const i=["%cmessia",[`background: ${e[t]}`,"border-radius: 0.3em","color: white","font-weight: bold","padding: 2px 0.5em"].join(";")];!1!==messiaVars.scriptDebug&&console[t](...i,...s)},s={},i=Object.keys(e);for(const e of i){const i=e;s[i]=(...e)=>{t(i,e)}}return s})();s.g.MessiaExt=s.g.MessiaExt||{},s.g.MessiaExt={...s.g.MessiaExt,logger:i}}},t={};function s(i){var o=t[i];if(void 0!==o)return o.exports;var n=t[i]={exports:{}};return e[i](n,n.exports,s),n.exports}s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),function(){"use strict";s(2591),s(247);(()=>{if("serviceWorker"in navigator)if(navigator.serviceWorker.addEventListener("message",(e=>{const t=e.data;"logger"===t.type&&MessiaExt.logger[t.method](t.body)})),1===messiaVars.pwaEnable){const e="caches"in self,t="indexedDB"in self,s=e=>{window.confirm(messiaVars.messages.workerUpdate)&&navigator.serviceWorker.addEventListener("controllerchange",(()=>{})),e&&e.waiting&&e.waiting.postMessage({command:"messiaSkipWaiting"})};navigator.serviceWorker.register(messiaVars.workerUrl,{scope:"/"}).then((i=>{MessiaExt.logger.log(`Worker registration succeeded. Scope is ${i.scope}`),!1===t?MessiaExt.logger.warn("Worker will skip caching cause the browser does not support indexedDB."):!1===e&&MessiaExt.logger.warn("Worker will skip caching cause the browser does not support cache storage."),i.waiting&&s(i)})).catch((e=>{MessiaExt.logger.error("Worker registration failed with "+e)}))}else navigator.serviceWorker.getRegistrations().then((e=>{if(e.length)for(let t of e)t.active.postMessage({command:"messiaUnregisterSelf"})}))})();var e;(e=jQuery)((function(){var t;e.fn.messiaStickyTextarea=function(){void 0!==this&&t.stickyTextarea(this)},e.fn.messiaStickyCodeMirror=function(e){for(var s=0;s<e.length;s++)t.stickyCodeMirror(e[s])},e.fn.messiaAppendMediaSelection=function(e,t){for(let s=0;s<t.length;s++){let i,o=e.clone();switch(t[s].type){case"wp-image":i=`<img class="image" src="${t[s].url}"/>`;break;case"icon":"google-material"===t[s].iconSetId?i=`<span class="image ${t[s].variant.cssClass.join(" ")}">${t[s].icon}</span>`:console.error(new Error(`Unknown icon set id: ${t[s].iconSetId}`));break;default:console.error(new Error(`Unknown image type: ${t[s].type}`))}e.hasClass("multiple")?(o.removeClass(["multiple","template"]).find(".image").remove(),o.data("imageinfo",t[s]).append(i),o.find(".placeholder-image").removeClass("placeholder-image").addClass("remove-image").after('<span class="edit-link"></span>'),o.insertBefore(e)):(e.find(".image").remove(),e.data("imageinfo",t[s]).append(i),e.find(".placeholder-image").removeClass("placeholder-image").addClass("remove-image"))}},e.fn.messiaModalWarning=function(e,s,i=!1){return t.dialogOpen(t.dialog_object,e,s,i)},e.fn.messiaIsMobile=function(){return!!/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)},e.fn.messiaInitSelect2=function(e){for(var t=0;t<e.length;t++)e[t].selector.hasClass("select2-hidden-accessible")||(e[t].selector.select2(e[t].arguments),e[t].selector.on("change",(function(e){this.dispatchEvent(new Event("select2Change",{bubbles:!0}))})))},t={select2Multiple:"",select2Async:"",stickyTransition:600,dialog_object:e("#messia_modal_warning"),dialog_arg:{autoOpen:!1,modal:!0,appendTo:"body",show:{effect:"drop",direction:"up",duration:250},hide:{effect:"drop",direction:"down",duration:250},beforeClose:function(e,t){},open:function(e,t){},close:function(t,s){e(this).dialog("destroy")},position:{my:"center center",at:"center center",of:window},minWidth:e(window).width()/2,minHeight:e(window).height()/3},dialogOpen:function(s,i,o,n=!1){if(s.dialog(t.dialog_arg),s.dialog("instance").element.empty().html(o),!1!==i&&s.dialog("instance").uiDialogTitlebar.find(".ui-dialog-title").text(i),!1===n){var a="messia-core-dialog-warning";n=[{text:e(this).get(0).dialog_object.data("settings").button_Text,click:function(){e(this).dialog("close")}}]}else if(0===n.length){a="messia-core-dialog-warning no-close";var r={Cancel:function(t){e(this).trigger("dialogClosed",["cancel"]),e(this).dialog("close")},OK:function(t){e(this).trigger("dialogClosed",["ok"]),e(this).dialog("close")}}}else a="messia-core-dialog-warning no-close",r=n;return s.dialog("option",{dialogClass:a,buttons:r}),s.dialog("widget").draggable("option",{scroll:!1,containment:"window"}),s.dialog("open"),e(".custom-scope .ui-widget-overlay").css({background:"#000000"}),s.dialog("instance")},ajaxResponseFill:function(t){var s=e("#ajax-response");if(!1===s.prev().hasClass("wp-header-end")){var i=e("#wpbody .wrap .wp-header-end");i.length>=1&&(i=i.first(),s.detach().insertAfter(i))}s.find(".messia").remove(),1===s.length&&s.append(t),e(document).trigger("wp-updates-notice-added")},ajaxSuccess:function(e,s,i){void 0!==i.data&&t.inlineSaveSuccess(e,s,i)},inlineSaveSuccess:function(e,s,i){var o,n=new URLSearchParams(i.data);t.dialog_object.length,"messia_object_segment"==n.get("taxonomy")?"inline-save-tax"==n.get("action")?o='<div class="messia notice notice-success is-dismissible"><p>'+messiaVars.messages.segmentPageUpdated+"</p></div>":"add-tag"==n.get("action")?(o='<div class="messia notice notice-success is-dismissible"><p>'+messiaVars.messages.segmentPageAdded+"</p></div>",n.get("slug")==n.get("alias")&&""!==n.get("slug")&&(o=o+'<div class="messia notice notice-error is-dismissible"><p>'+messiaVars.messages.segmentAliasSlug+"</p></div>")):"delete-tag"==n.get("action")&&(o='<div class="messia notice notice-warning is-dismissible"><p>'+messiaVars.messages.segmentPageDeleted+"</p></div>"):"messia_object_category"==n.get("taxonomy")&&"inline-save-tax"==n.get("action")&&("reset"===n.get("term_order_position_type")&&"before"===n.get("term_order_position_type")&&"after"===n.get("term_order_position_type")||(o='<div class="messia notice notice-success is-dismissible"><p>'+messiaVars.messages.termsReordered+"</p></div>")),"messia_object_property"==n.get("taxonomy")&&("inline-save-tax"!=n.get("action")&&"add-tag"!=n.get("action")||!messiaVars.reservedTerms.messia_object_property.includes(n.get("slug"))||(o='<div class="messia notice notice-error is-dismissible"><p>'+messiaVars.messages.propertySlugReserved+"</p></div>"),"inline-save-tax"==n.get("action")&&("reset"===n.get("term_order_position_type")&&"before"===n.get("term_order_position_type")&&"after"===n.get("term_order_position_type")||(o+='<div class="messia notice notice-success is-dismissible"><p>'+messiaVars.messages.termsReordered+"</p></div>"))),"page"==n.get("post_type")&&"inline-save"==n.get("action")&&!0===Boolean(s.getResponseHeader("Messia-Page-Edit-Forbidden"))&&(o='<div class="messia notice notice-error is-dismissible"><p>'+messiaVars.messages.dependantPageUpdWarn+"</p></div>"),void 0!==o&&t.ajaxResponseFill(o)},stickyTextarea:function(e){e.on("keyup keypress",t.textareaKeyup),e.on("focusin",t.textareaFocusin),e.on("focusout",t.textareaFocusout)},stickyCodeMirror:function(s){e(s.getWrapperElement()),s.on("keyup",t.codemirrorKeyup),s.on("focus",t.codemirrorFocusin),s.on("blur",t.codemirrorsFocusout),s.on("refresh",t.codeMirrorRefresh)},textareaKeyup:function(s){var i=e(this);if(i.outerHeight()<=i.prop("scrollHeight")){var o=parseInt(i.css("borderTopWidth"))+parseInt(i.css("borderBottomWidth"));i.css("transition","all "+t.stickyTransition+"ms cubic-bezier(0.71, -0.01, 0.26, 0.98)"),i.css("height",i.prop("scrollHeight")+o),setTimeout((function(){i.css("transition","")}),t.stickyTransition)}},textareaFocusin:function(s){var i=e(this);i.data("init_height",i.outerHeight()),i.css("transition","all "+t.stickyTransition+"ms cubic-bezier(0.71, -0.01, 0.26, 0.98)"),clearTimeout(i.data("focusOutInt_1")),clearTimeout(i.data("focusOutInt_2")),i.css("width","100%");var o=setTimeout((function(){var e=i.prop("scrollHeight"),s=i.data("init_height"),o=parseInt(i.css("borderTopWidth"))+parseInt(i.css("borderBottomWidth"));i.css("height",i.data("init_height")),e<=s||(i.css("height",i.prop("scrollHeight")+o),setTimeout((function(){i.css("transition","")}),t.stickyTransition))}),t.stickyTransition/2);i.data("focusInInt",o)},textareaFocusout:function(s){var i=e(this);clearTimeout(i.data("focusInInt")),i.css("transition","all "+t.stickyTransition+"ms cubic-bezier(0.71, -0.01, 0.26, 0.98)"),i.css("height",i.data("init_height"));var o=setTimeout((function(){i.css("width","")}),t.stickyTransition/4),n=setTimeout((function(){i.css("transition",""),i.css("height","")}),t.stickyTransition+t.stickyTransition/4);i.data("focusOutInt_1",o),i.data("focusOutInt_2",n)},codemirrorKeyup:function(s,i){var o=e(s.getWrapperElement()),n=o.outerHeight(),a=s.getScrollerElement().scrollHeight,r=parseInt(o.css("borderTopWidth"))+parseInt(o.css("borderBottomWidth"));n<=a&&(o.css("transition","all "+t.stickyTransition+"ms cubic-bezier(0.71, -0.01, 0.26, 0.98)"),o.css("height",o.find(".CodeMirror-sizer").prop("scrollHeight")+r),setTimeout((function(){o.css("transition","")}),t.stickyTransition))},codemirrorFocusin:function(s,i){var o=e(s.getWrapperElement());o.data("init_height",o.outerHeight()),o.css("transition","all "+t.stickyTransition+"ms cubic-bezier(0.71, -0.01, 0.26, 0.98)"),clearTimeout(o.data("focusOutInt_1")),clearTimeout(o.data("focusOutInt_2")),o.css("width","100%"),s.refresh()},codemirrorsFocusout:function(s,i){var o=e(s.getWrapperElement());o.css("transition","all "+t.stickyTransition+"ms cubic-bezier(0.71, -0.01, 0.26, 0.98)"),clearTimeout(o.data("focusInInt_1")),clearTimeout(o.data("focusInInt_2")),o.css("height",o.data("init_height"));var n=setTimeout((function(){o.css("width","")}),t.stickyTransition/4),a=setTimeout((function(){o.css("transition",""),o.css("height","")}),t.stickyTransition+t.stickyTransition/4);o.data("focusOutInt_1",n),o.data("focusOutInt_2",a)},codeMirrorRefresh:function(s){var i=e(s.getWrapperElement()),o=i.find(".CodeMirror-sizer").prop("scrollHeight"),n=setTimeout((function(){var e=parseInt(i.css("borderTopWidth"))+parseInt(i.css("borderBottomWidth")),t=i.prop("scrollHeight");s.getScrollerElement().scrollHeight<=t||(i.css("height",i.data("init_height")),i.css("height",o+e))}),t.stickyTransition/2),a=setTimeout((function(){i.css("transition","")}),2*t.stickyTransition);i.data("focusInInt_1",n),i.data("focusInInt_2",a)},requireNameOption:function(){var t=e('form[action="options.php"] #require_name_email');if(0!==t.length){var s=t.attr("type","radio").parent("label").clone(!0).attr("for","require_name").insertAfter(t.parent("label"));s.get(0).childNodes[1].textContent=" "+messiaVars.messages.requireName,s.find("input").attr({value:"",id:"require_name"}),e("<br>").insertBefore(s),!0===s.find("input").prop("checked")?(s.find("input").prop("checked",!1),t.prop("checked",!0)):s.find("input").prop("checked",!0)}},reinitFragments:function(t){e.fn.messiaInitSelect2([{selector:e(t.target).find("select"),arguments:{placeholder:messiaVars.messages.selectOptions,minimumResultsForSearch:1/0,width:"100%"}}])},setDirtyActions:function(s){e(window).off("beforeunload",t.beforeunload),e(window).on("beforeunload",t.beforeunload),e(document).data("messiaDirty",!0)},clearDirtyActions:function(s){e(window).off("beforeunload",t.beforeunload),e(document).data("messiaDirty",!1)},beforeunload:function(e){return!0}},e(document).ajaxSuccess(t.ajaxSuccess),t.requireNameOption(),!0===e.fn.messiaIsMobile()&&(t.select2Multiple="[multiple]",t.select2Async=".async"),e.fn.messiaInitSelect2([{selector:e(`select[id="category_parent"]${t.select2Multiple}, select[id="category_parent"]${t.select2Async}`),arguments:{placeholder:messiaVars.messages.selectOptions,minimumResultsForSearch:1/0}},{selector:e(`select[id="property_group"]${t.select2Multiple}, select[id="property_group"]${t.select2Async}`),arguments:{minimumResultsForSearch:1/0}},{selector:e(`.metabox-constructor-fields select${t.select2Multiple}, .metabox-constructor-fields select${t.select2Async}`),arguments:{placeholder:messiaVars.messages.selectOptions,minimumResultsForSearch:1/0,width:"100%"}}]),e("body").on("objectMetaboxUpdated",t.reinitFragments),e(document).on("messiaContentIsDirty",t.setDirtyActions),e(document).on("messiaContentIsSaved",t.clearDirtyActions)}))}()}();