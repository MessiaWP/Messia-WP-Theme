!function(){var e={8908:function(e,t,a){!function(e,t){const{apiFetch:s}=e,{registerBlockType:r}=e.blocks,{Component:l,Fragment:c,useState:n,useEffect:i,useRef:o}=e.element,{serverSideRender:m}=e,{InspectorControls:d,BlockControls:u}=e.blockEditor,{ToggleControl:f,Flex:p,FlexItem:h,PanelBody:g,Notice:v,CheckboxControl:y,SelectControl:b,ToolbarGroup:E,ToolbarButton:R,Placeholder:C,Disabled:k,Card:x,Spinner:N,TabPanel:w,TextControl:S}=e.components,{__:A}=e.i18n,P=a(4670),z=React.createElement("svg",{viewBox:"0 0 274 37",xmlns:"http://www.w3.org/2000/svg"},React.createElement("g",{className:"layer"},React.createElement("g",{id:"svg_17"},React.createElement("g",{id:"svg_11"},React.createElement("rect",{fill:"#ffffff",height:"27.828067",id:"svg_8",rx:"2",ry:"2",stroke:"#c2c2c2",width:"118.736076",x:"4.439902",y:"4.654716"}),React.createElement("path",{d:"m105.198331,21.787673l3.678772,-6.437851l3.678772,6.437851l-7.357544,0z",fill:"#000000",id:"svg_1",stroke:"#000000",transform:"rotate(-180 108.877 18.5687)"})),React.createElement("g",{id:"svg_12"},React.createElement("rect",{fill:"#ffffff",height:"27.828067",id:"svg_2",rx:"2",ry:"2",stroke:"#c2c2c2",width:"63.505948",x:"132.682586",y:"4.654716"}),React.createElement("text",{fill:"#000000",fontFamily:"Monospace",fontSize:"18",fontStyle:"normal",fontWeight:"normal",id:"svg_6",stroke:"#000000",textAnchor:"middle",transform:"matrix(0.911025 0 0 0.944903 4.59916 6.87916)",x:"198.875684",y:"18.342526"},"I")),React.createElement("g",{id:"svg_15"},React.createElement("rect",{fill:"black",height:"27.828067",id:"svg_9",rx:"2",ry:"2",width:"63.505948",x:"206.531949",y:"4.654717"}),React.createElement("text",{fill:"#ffffff",fontFamily:"Cursive",fontSize:"24",id:"svg_10",stroke:"#000000",strokeWidth:"0",textAnchor:"middle",transform:"matrix(0.547485 0 0 0.500406 46.8212 52.8191)",x:"351.239178",y:"-63"},"Search")))));let T=!1;r("messia/block-search-snippet",{title:A("Search snippet","messia"),description:A("Constructor of search filters","messia"),icon:React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},React.createElement("path",{d:"M13 8h-8v-1h8v1zm0 2h-8v-1h8v1zm-3 2h-5v-1h5v1zm11.172 12l-7.387-7.387c-1.388.874-3.024 1.387-4.785 1.387-4.971 0-9-4.029-9-9s4.029-9 9-9 9 4.029 9 9c0 1.761-.514 3.398-1.387 4.785l7.387 7.387-2.828 2.828zm-12.172-8c3.859 0 7-3.14 7-7s-3.141-7-7-7-7 3.14-7 7 3.141 7 7 7z"})),category:"messia",keywords:["search"],styles:[],variations:[],attributes:{filtersConstructed:{type:"array",default:[]},isExample:{type:"boolean",default:!1},withCount:{type:"boolean",default:!0},selectAllCatAlias:{type:"string",default:A("Select Category","messia")},selectAllPropAlias:{type:"string",default:A("Select Property","messia")}},example:{attributes:{isExample:!0}},supports:{multiple:!1},edit:function(a){const{attributes:r,setAttributes:l,className:M,name:_}=a,[D,j]=n(t()),[O,$]=n(!0),[B,F]=n(!1),[I,V]=n({segment:[],category:[],property:[]});let W=o();const q=e=>{t(e.target).parents(".messia-filter").animate({opacity:0},400,(function(){t(this).addClass("removed").css("display","none");const e=t(W.current).find(".filters-constructed .messia-filter");H(e)}))},L=()=>{const e=t(W.current).find(".filters-constructed").not("ui-sortable").sortable({forceHelperSize:!0,forcePlaceholderSize:!0,opacity:1,tolerance:"intersect",scroll:!0,scrollSensitivity:20,containment:".edit-post-visual-editor",placeholder:"sortable-placeholder",handle:".move",start:(e,a)=>{a.item.addClass("is-elevated"),t("body").addClass("cursor-grabbing")},beforeStop:(e,a)=>{t("body").removeClass("cursor-grabbing")},stop:(e,t)=>{t.item.removeClass("is-elevated"),Q(t).then((e=>{j(e.item)}))}});t(W.current).find(".filters-templates .messia-filter").not(".ui-draggable").draggable({connectToSortable:".filters-constructed",helper:"clone",revert:"invalid",scroll:!1,revertDuration:200,handle:".move",zIndex:10,start:(a,s)=>{s.helper.addClass("is-elevated"),t("body").addClass("cursor-grabbing"),e.addClass("dragging")},beforeStop:(e,a)=>{t("body").removeClass("cursor-grabbing")},stop:(t,a)=>{a.helper.removeClass("is-elevated"),e.removeClass("dragging")}})},H=e=>{let a=[];const s=e.parents(".messia-tabs-panel").find('[role="tabpanel"]').attr("id").match(/segment-(.+)-slug/)[1];for(let e=0;e<r.filtersConstructed.length;e++)r.filtersConstructed[e].segmentSlug!==s&&a.push(r.filtersConstructed[e]);for(let r=0;r<e.length;r++){let l;if(t(e[r]).hasClass("removed"))continue;l=void 0===t(e[r]).data("key")?P.generate():t(e[r]).data("key");switch(t(e[r]).data("type")){case"string":a.push({id:l,segmentSlug:s,by:"string"});break;case"category":a.push({id:l,segmentSlug:s,selectAllCatAlias:t(e[r]).find(".settings .select-all-alias input").val(),by:"category",value:t(e[r]).find(".settings select").val()});break;case"property":let n=[],i=t(e[r]).find('.settings input[type="checkbox"]');for(var c=0;c<i.length;c++)t(i[c]).prop("checked")&&n.push(t(i[c]).val());a.push({id:l,segmentSlug:s,selectAllPropAlias:t(e[r]).find(".settings .select-all-alias input").val(),by:"property",value:n})}}D.hasClass("ui-draggable")&&D.addClass("remove-before-render"),l({filtersConstructed:a})},Q=async e=>{if(e.item.hasClass("saved"))return Promise.resolve(e);const a=e.item.outerWidth();e.item.css({height:"",width:""});const s=e.item.outerWidth();return e.item.css({width:a}).addClass("dropped"),await new Promise(((a,r)=>{e.item.animate({width:s+"px"},200,(function(){t(this).css({width:""});const s=e.item.find(".settings");if(0===s.length)e.item.addClass("saved"),a(e);else{s.css("display","block");const r=s.outerHeight(),l=s.outerWidth();s.css({height:0,width:0}),s.animate({height:r+"px",width:l+"px"},300,(function(){t(this).css({height:"",width:""}),e.item.addClass("saved"),a(e)}))}}))}))},U=()=>{if(B){if(I.segment.length>0){const a=[];for(const[e,t]of I.segment.entries())a.push({name:`segment-${t.value}-slug`,title:t.label,className:"tab",segmentSlug:t.value});const s=React.createElement(w,{className:"messia-tabs-panel",activeClass:"active-tab",orientation:"horizontal",initialTabName:a[0].name,tabs:a},(e=>React.createElement("div",{"data-title":A("Drop item here.","messia"),className:"messia-drop-zone filters-constructed"},(e=>{const a=[];for(const[c,n]of r.filtersConstructed.entries())if(e.segmentSlug==n.segmentSlug)switch(n.by){case"string":a.push(React.createElement(x,{className:"messia-card messia-filter dropped saved",key:`${n.by}-${n.id}`,"data-type":"string",size:"small"},React.createElement("div",{className:"messia-card-content"},React.createElement(p,{gap:2},React.createElement(h,{className:"move"},"≡"),React.createElement(h,{className:"heading"},A("by String","messia")),React.createElement(h,{className:"remove",onClick:q})))));break;case"category":var s=r.selectAllCatAlias;void 0!==r.filtersConstructed[c].selectAllCatAlias&&(s=r.filtersConstructed[c].selectAllCatAlias);const e=React.createElement(x,{className:"messia-card messia-filter category dropped saved",key:`${n.by}-${n.id}`,"data-type":"category",size:"small"},React.createElement("div",{className:"messia-card-content"},React.createElement(p,{gap:2},React.createElement(h,{className:"move"},"≡"),React.createElement(h,{className:"heading"},A("by Category","messia")),React.createElement(h,{className:"remove",onClick:q})),React.createElement("div",{className:"settings"},React.createElement("div",{className:"settings-inner"},React.createElement("div",{className:"select-all-alias"},React.createElement(S,{label:A("Set name for Select All option","messia"),className:"alias",type:"text",value:s,onChange:e=>{let t=r.filtersConstructed;delete r.filtersConstructed,t[c].selectAllCatAlias=e,l({filtersConstructed:t})}})),React.createElement(b,{value:r.filtersConstructed[c].value,onChange:e=>{let t=r.filtersConstructed;delete r.filtersConstructed,t[c].value=e,l({filtersConstructed:t})},options:I.category})))));a.push(e);break;case"property":const i=[];for(const[e,a]of I.property.entries()){const e=React.createElement(y,{key:a.value,value:a.value,label:a.label,checked:r.filtersConstructed[c].value.includes(a.value),onChange:e=>{let a=r.filtersConstructed;delete r.filtersConstructed,a[c].value=[],e=t(event.target).parents(".settings").find('input[type="checkbox"]:checked');for(var s=0;s<e.length;s++)a[c].value.push(t(e[s]).val());l({filtersConstructed:a})}});i.push(e)}s=r.selectAllCatAlias,void 0!==r.filtersConstructed[c].selectAllPropAlias&&(s=r.filtersConstructed[c].selectAllPropAlias),a.push(React.createElement(x,{className:"messia-card messia-filter property dropped saved",key:`${n.by}-${n.id}`,"data-type":"property",size:"small"},React.createElement("div",{className:"messia-card-content"},React.createElement(p,{gap:2},React.createElement(h,{className:"move"},"≡"),React.createElement(h,{className:"heading"},A("by Property","messia")),React.createElement(h,{className:"remove",onClick:q})),React.createElement("div",{className:"settings"},React.createElement("div",{className:"select-all-alias"},React.createElement(S,{label:A("Set name for Select All option","messia"),className:"alias",type:"text",value:s,onChange:e=>{let t=r.filtersConstructed;delete r.filtersConstructed,t[c].selectAllPropAlias=e,l({filtersConstructed:t})}})),React.createElement("div",{className:"properties"},i)))))}return a})(e))));return React.createElement(C,{key:"messia-block-placeholder"},React.createElement("div",{className:"messia-block",key:"messia-block",ref:W},React.createElement("div",{className:"filters-templates"},(()=>{const t=e.blocks.getBlockType(_),a=[React.createElement(c,{key:"tip"},React.createElement("h4",null,t.title),React.createElement(v,{isDismissible:!1,status:"warning"},React.createElement("p",null,A('The list of terms is subordinate to the value of the "Empty category/property terms" option. This list of categories contains all the key terms of the Category taxonomy, i.e. terms that have descendants. In the frontend, this list will show all the descendants of the term selected here.',"messia"))))];if(a.push(React.createElement(x,{className:"messia-card messia-filter",key:"tmpl-by-string","data-type":"string",size:"small"},React.createElement("div",{className:"messia-card-content"},React.createElement(p,{gap:2},React.createElement(h,{className:"move"},"≡"),React.createElement(h,{className:"heading"},A("by String","messia")),React.createElement(h,{className:"remove",onClick:q}))))),I.category.length>0&&a.push(React.createElement(x,{className:"messia-card messia-filter category",key:"tmpl-by-category","data-type":"category",size:"small"},React.createElement("div",{className:"messia-card-content"},React.createElement(p,{gap:2},React.createElement(h,{className:"move"},"≡"),React.createElement(h,{className:"heading"},A("by Category","messia")),React.createElement(h,{className:"remove",onClick:q})),React.createElement("div",{className:"settings"},React.createElement("div",{className:"settings-inner"},React.createElement("div",{className:"select-all-alias"},React.createElement(S,{label:A("Set name for Select All option","messia"),className:"alias",type:"text",value:r.selectAllCatAlias})),React.createElement(b,{value:I.category[0].value,options:I.category})))))),I.property.length>0){const e=[];for(const[t,a]of I.property.entries())e.push(React.createElement(y,{key:a.value,value:a.value,label:a.label,onChange:e=>{let t=r.filtersConstructed;if(delete r.filtersConstructed,e)t[index].value.push(event.target.value);else{const e=t[index].value.indexOf(event.target.value);delete t[index].value[e]}l({filtersConstructed:t})}}));a.push(React.createElement(x,{className:"messia-card messia-filter property",key:"tmpl-by-property","data-type":"property",size:"small"},React.createElement("div",{className:"messia-card-content"},React.createElement(p,{gap:2},React.createElement(h,{className:"move"},"≡"),React.createElement(h,{className:"heading"},A("by Property","messia")),React.createElement(h,{className:"remove",onClick:q})),React.createElement("div",{className:"settings"},React.createElement("div",{className:"select-all-alias"},React.createElement(S,{label:A("Set name for Select All option","messia"),type:"text",value:r.selectAllPropAlias})),React.createElement("div",{className:"properties"},e)))))}return a})()),s))}return React.createElement(C,{key:"messia-block-placeholder",label:A("You have no segments. Create one.","messia")},React.createElement("div",{className:"messia-block",key:"messia-block",ref:W}))}return React.createElement(C,{key:"messia-block-placeholder"},React.createElement("div",{className:"messia-block",key:"messia-block",ref:W},React.createElement(N,null)))};return i((()=>{let t=!0;return B||r.isExample||(async()=>await s({path:"messia/v1/block-search-snippet",method:"POST",data:{currentAttrs:r}}).then((t=>(0===t.terms.segment.length?e.data.dispatch("core/notices").createNotice("error",A("Messia Search Snippet: No terms were found in taxonomy Segment. Unit operation is not possible.","messia"),{isDismissible:!0}):(0===t.terms.category.length&&e.data.dispatch("core/notices").createNotice("error",A("Messia Search Snippet Terms: No terms were found in taxonomy Category. Add some to use filter.","messia"),{isDismissible:!0}),0===t.terms.property.length&&e.data.dispatch("core/notices").createNotice("error",A("Messia Search Snippet Terms: No terms were found in taxonomy Property. Add some to use filter.","messia"),{isDismissible:!0})),t))).catch((t=>{e.data.dispatch("core/notices").createNotice("error",A("An error occurred while receiving data from the server for Search snippet block","messia"),{isDismissible:!0})})))().then((e=>{t&&(l({filtersConstructed:e.validAttrs.filtersConstructed}),V(e.terms),F(!0))})),()=>{t=!1}}),[B]),i((()=>{O||r.isExample||t(W.current).find(".filters-constructed").sortable("destroy")}),[O]),i((()=>{if(0===D.length)return;const e=t(W.current).find(".filters-constructed .messia-filter");H(e)}),[D]),i((()=>{new MutationObserver(((e,a)=>{for(const a of e)if("childList"===a.type&&a.addedNodes.length>=1)for(let e=0;e<a.addedNodes.length;e++){t(a.addedNodes[e]).find(".filters-constructed").length>0&&L()}})).observe(document.querySelector("body"),{attributes:!1,childList:!0,subtree:!0})}),[]),(()=>{if(r.isExample)return z;{D.hasClass("remove-before-render")&&D.remove();let e=[M];const t=[React.createElement(d,{key:"inspector"},React.createElement(g,{title:A("Settings","messia")},React.createElement(f,{label:A("Show on front number of objects per term.","messia"),checked:r.withCount,onChange:e=>{l({withCount:e})}}))),React.createElement(u,{key:"block"},React.createElement(E,{label:A("Options","messia")},React.createElement(R,{label:A(O?"Preview":"Edit","messia"),icon:O?"visibility":"edit",onClick:()=>{$(!O)}})))];return O?(t.push(U()),T=!1):(T||(T=React.createElement("div",{className:"messia-block",key:"messia-block",ref:W},React.createElement(k,{key:"block-preview"},React.createElement(m,{block:_,attributes:r,urlQueryArgs:{isPreview:!0}})))),t.push(T)),React.createElement("div",{className:e.join(" ")},t)}})()},save:function(e){return null}})}(window.wp,jQuery)},4670:function(e,t,a){"use strict";e.exports=a(5607)},9829:function(e,t,a){"use strict";var s,r,l,c=a(8946),n="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_-";function i(){l=!1}function o(e){if(e){if(e!==s){if(e.length!==n.length)throw new Error("Custom alphabet for shortid must be "+n.length+" unique characters. You submitted "+e.length+" characters: "+e);var t=e.split("").filter((function(e,t,a){return t!==a.lastIndexOf(e)}));if(t.length)throw new Error("Custom alphabet for shortid must be "+n.length+" unique characters. These characters were not unique: "+t.join(", "));s=e,i()}}else s!==n&&(s=n,i())}function m(){return l||(l=function(){s||o(n);for(var e,t=s.split(""),a=[],r=c.nextValue();t.length>0;)r=c.nextValue(),e=Math.floor(r*t.length),a.push(t.splice(e,1)[0]);return a.join("")}())}e.exports={get:function(){return s||n},characters:function(e){return o(e),s},seed:function(e){c.seed(e),r!==e&&(i(),r=e)},lookup:function(e){return m()[e]},shuffled:m}},480:function(e,t,a){"use strict";var s,r,l=a(8416);a(9829);e.exports=function(e){var t="",a=Math.floor(.001*(Date.now()-1567752802062));return a===r?s++:(s=0,r=a),t+=l(7),t+=l(e),s>0&&(t+=l(s)),t+=l(a)}},8416:function(e,t,a){"use strict";var s=a(9829),r=a(3766),l=a(296);e.exports=function(e){for(var t,a=0,c="";!t;)c+=l(r,s.get(),1),t=e<Math.pow(16,a+1),a++;return c}},5607:function(e,t,a){"use strict";var s=a(9829),r=a(480),l=a(1082),c=a(5636)||0;function n(){return r(c)}e.exports=n,e.exports.generate=n,e.exports.seed=function(t){return s.seed(t),e.exports},e.exports.worker=function(t){return c=t,e.exports},e.exports.characters=function(e){return void 0!==e&&s.characters(e),s.shuffled()},e.exports.isValid=l},1082:function(e,t,a){"use strict";var s=a(9829);e.exports=function(e){return!(!e||"string"!=typeof e||e.length<6)&&!new RegExp("[^"+s.get().replace(/[|\\{}()[\]^$+*?.-]/g,"\\$&")+"]").test(e)}},3766:function(e){"use strict";var t,a="object"==typeof window&&(window.crypto||window.msCrypto);t=a&&a.getRandomValues?function(e){return a.getRandomValues(new Uint8Array(e))}:function(e){for(var t=[],a=0;a<e;a++)t.push(Math.floor(256*Math.random()));return t},e.exports=t},8946:function(e){"use strict";var t=1;e.exports={nextValue:function(){return(t=(9301*t+49297)%233280)/233280},seed:function(e){t=e}}},5636:function(e){"use strict";e.exports=0},296:function(e){e.exports=function(e,t,a){for(var s=(2<<Math.log(t.length-1)/Math.LN2)-1,r=-~(1.6*s*a/t.length),l="";;)for(var c=e(r),n=r;n--;)if((l+=t[c[n]&s]||"").length===+a)return l}}},t={};function a(s){var r=t[s];if(void 0!==r)return r.exports;var l=t[s]={exports:{}};return e[s](l,l.exports,a),l.exports}a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,{a:t}),t},a.d=function(e,t){for(var s in t)a.o(t,s)&&!a.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){"use strict";a(8908)}()}();