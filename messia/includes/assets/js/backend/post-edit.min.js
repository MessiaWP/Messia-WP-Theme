!function(){var e={2319:function(){var e;(e=jQuery)((function(){"use strict";var t;wp.apiFetch.use((function(e,i){var n=i(e);return n.then((function(e){t.proccessResponse(e)})).catch((function(e){t.proccessResponse(e)})),n})),t={selectMedia:function(){e(this).messiaMediaSelector(t.imageSelected)},removeMedia:function(i){i.stopPropagation();var n=e(this).parents(".field");e(this).parents(".icon").remove(),t.updateImagesInput(n),t.gallerySortableAbility(n)},imageSelected:function(i,n){e.fn.messiaAppendMediaSelection(i,n);var o=i.parents(".field");t.updateImagesInput(o),t.gallerySortableAbility(o)},updateImagesInput:function(t){var i=[],n=t.find(".icon"),o=t.find(".storage");o.empty();for(var a=0;a<n.length;a++)if(0===e(n[a]).find(".placeholder-image").length){var s=e(n[a]).data("imageinfo");void 0===s.userLink&&(s.userLink=""),delete s.url;for(const e in s)o.append(`<input type="hidden" name="${o.data("name")}[${a}][${e}]" value="${s[e]}">`);i.push(e(n[a]).data("imageinfo"))}},editLinkImage:function(t){t.stopPropagation();var i=e(this).parents(".field").find(".link-wrapper"),n=e(this).parent(".icon");e(this).addClass("on-edit"),i.hide({effect:"drop",direction:"down",duration:300,complete:function(){e(this).show({effect:"drop",direction:"down",duration:300}).data("caller",n).find("input.data").val(n.data("imageinfo").userLink)}})},commitLinkImage:function(i){var n=e(this).parent(".link-wrapper"),o=n.data("caller"),a=e(this).parent(".link-wrapper").find("input.data").val();o.hasClass("icon")&&(o.data("imageinfo").userLink=a,t.updateImagesInput(n.parent(".field")),""===a?o.find(".edit-link").removeClass("linked"):o.find(".edit-link").addClass("linked"),o.find(".edit-link").removeClass("on-edit")),n.hide({effect:"drop",direction:"down",duration:300})},editLinkUrl:function(t){t.stopPropagation();var i=e(this).parents(".field"),n=i.find(".link-wrapper");i.find(".edit-link").addClass("on-edit"),n.show({effect:"drop",direction:"down",duration:300})},commitLinkUrl:function(t){var i=e(this).parent(".link-wrapper"),n=i.find('input[type="url"]').val(),o=i.prev(".input-link").find(".edit-link");""===n?o.removeClass("linked"):o.addClass("linked"),o.removeClass("on-edit"),i.hide({effect:"drop",direction:"down",duration:300})},makeRadioButtons:function(){e("#messia_object_segmentchecklist input").each((function(){this.type="radio"}))},newSegmentObserver:function(){var e=document.getElementById("messia_object_segmentchecklist");null!==e&&new MutationObserver((function(e){for(var i of e)"childList"==i.type&&t.makeRadioButtons()})).observe(e,{attributes:!0,childList:!0,subtree:!0})},proccessResponse:function(e){t.googleGeoResponse(e),t.messiaResponse(e)},messiaResponse:function(e){if(void 0!==e.messiaData&&(void 0!==e.messiaData.saved&&!1===e.messiaData.saved&&wp.data.dispatch("core/notices").createNotice("error",e.messiaData.comment,{id:"messia/page-undeletable",isDismissible:!0}),void 0!==e.messiaData.reload&&!0===e.messiaData.reload))var t=!1,i=wp.data.subscribe((function(){wp.data.select("core/editor").isSavingPost()||(i(),!1===t&&(alert(messiaVars.messages.postReloadPending),window.location.reload(),t=!0))}))},googleGeoResponse:function(e){if(void 0!==e.headers){var t=e.headers.get("Google-Geo-Coder");""!==t&&null!==t&&("OK"===t?e.text().then((function(e){for(var t=jQuery,i=t.parseHTML(e),n=t(i).find('div[id^="segment-constructor-term-id"]'),o=t('div[id^="segment-constructor-term-id"]'),a=0;a<o.length;a++)for(var s=t(o[a]).find(".address-field"),r=t(n[a]).find(".address-field"),d=0;d<s.length;d++)t(s[d]).replaceWith(t(r[d]))})):wp.data.dispatch("core/notices").createNotice("warning",t,{id:"messia/google-geocoder-info",isDismissible:!0}))}},forceSetSegment:function(){let e=!1;return wp.data.subscribe((()=>{const t=wp.data.select("core/editor").getEditedPostAttribute("messia_object_segment");void 0!==t&&(0===t.length?e||(e=!0,wp.data.dispatch("core/editor").lockPostSaving("messia/segment-lock-saving"),wp.data.dispatch("core/notices").createNotice("warning",messiaVars.messages.segmentIsEmpty,{id:"messia/segment-lock-saving-notice",isDismissible:!1})):e&&(e=!1,wp.data.dispatch("core/editor").unlockPostSaving("messia/segment-lock-saving"),wp.data.dispatch("core/notices").removeNotice("messia/segment-lock-saving-notice")))}))},gallerySortableAbility:function(e){var t=e.find(".icon-wrapper");t.find(".icon").length<=2?t.sortable("disable"):t.sortable("enable")},initGallery:function(i){for(var n=e(".metabox-constructor-fields .icon-wrapper"),o=0;o<n.length;o++){var a=e(n[o]);n.sortable({forceHelperSize:!0,forcePlaceholderSize:!0,opacity:.5,items:"> .icon",distance:10,tolerance:"pointer",scroll:!1,placeholder:"sortable-placeholder",beforeStop:function(e,i){i.helper.css({height:"",width:""}),t.updateImagesInput(i.item.parents(".field"))},stop:function(e,t){this.dispatchEvent(new Event("sortableChange",{bubbles:!0}))}});var s=a.parents(".field");t.gallerySortableAbility(s)}},createEvents:function(){var e=!0,t=!1;wp.data.subscribe((()=>{var i=wp.data.select("core/editor").isSavingPost(),n=wp.data.select("core/editor").isAutosavingPost();i&&e&&!n&&(e=!1,t=!0,document.dispatchEvent(new Event("savePostStart",{bubbles:!1})),wp.data.subscribe((()=>{var i=wp.data.select("core/editor").isSavingPost(),n=wp.data.select("core/editor").isAutosavingPost();i||!t||n||(e=!0,t=!1,document.dispatchEvent(new Event("savePostFinish",{bubbles:!1})))})))}))},reinitFragments:function(i){t.initGallery(),e(i.target).find("textarea.messia").messiaStickyTextarea()},setDirty:function(t){e(document).trigger("messiaContentIsDirty")},clearDirty:function(t){e(document).trigger("messiaContentIsSaved")},removeNoticesOnSavePost:function(e){wp.data.dispatch("core/notices").removeNotice("messia/page-undeletable"),wp.data.dispatch("core/notices").removeNotice("messia/google-geocoder-info")}},e("body").on("objectMetaboxUpdated",t.reinitFragments),e("body").on("click touchstart",".metabox-constructor-fields .icon .edit-image",t.selectMedia),e("body").on("click touchstart",".metabox-constructor-fields .icon .remove-image",t.removeMedia),e("body").on("click",".metabox-constructor-fields .icon .edit-link",t.editLinkImage),e("body").on("focus",".metabox-constructor-fields .input-link input",t.editLinkUrl),e("body").on("click",".metabox-constructor-fields .field .link-wrapper #commit-image-link",t.commitLinkImage),e("body").on("click",".metabox-constructor-fields .field .link-wrapper #commit-url-link",t.commitLinkUrl),e("textarea.messia").messiaStickyTextarea(),e(".macs .metabox-constructor-fields .field .messia-help-tip").tooltip(),e(".macs .metabox-comment-fields .field .messia-help-tip").tooltip(),e("body").on("input",'div[id^="segment-constructor-term-id"] input, div[id^="segment-constructor-term-id"] textarea, div[id^="segment-constructor-term-id"] select',t.setDirty),e("body").on("input",'div[id^="segment-stuff-term-id"] input, div[id^="segment-stuff-term-id"] textarea, div[id^="segment-stuff-term-id"] select',t.setDirty),e("form#post").on("submit",t.clearDirty),e(document).on("savePostStart",t.removeNoticesOnSavePost),e(document).on("savePostFinish",t.clearDirty),t.initGallery(),t.newSegmentObserver(),t.makeRadioButtons(),t.forceSetSegment(),t.createEvents()}))}},t={};function i(n){var o=t[n];if(void 0!==o)return o.exports;var a=t[n]={exports:{}};return e[n](a,a.exports,i),a.exports}i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,{a:t}),t},i.d=function(e,t){for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){"use strict";i(2319)}()}();